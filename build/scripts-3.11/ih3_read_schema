#!python
import argparse

def getCmdArgs():
    p = argparse.ArgumentParser(description = "List variables available in the GEDI H3 database")
    p.add_argument("-i", "--input", dest="input", required=True, type=str, help="directory or file path [parquet or gpkg] - generated by `gh3_extract_shots`")
    cmdargs = p.parse_args()
    return cmdargs


if __name__ == '__main__':
    args = getCmdArgs()
    
    import glob, os
    from gedih3 import read_parquet_schema, read_geopackage_schema
    
    f = args.input if os.path.isfile(args.input) else glob.glob(args.input + '/*')[0]
    is_parquet = f.endswith('.parquet') or f.endswith('.pq') or f.endswith('.parq')
    cols = read_parquet_schema(f) if is_parquet else read_geopackage_schema(f)
   
    print(cols.to_markdown())